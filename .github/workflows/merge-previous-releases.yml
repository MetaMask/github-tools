name: Merge Previous Releases

on:
  workflow_call:
    inputs:
      new-release-branch:
        required: true
        type: string
        description: 'The newly created release branch (e.g., release/2.1.2)'
    secrets:
      github-token:
        required: true
        description: 'GitHub token for authentication'

  workflow_dispatch:
    inputs:
      new-release-branch:
        required: true
        type: string
        description: 'The newly created release branch (e.g., release/2.1.2)'

jobs:
  merge-previous-releases:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v5
        with:
          ref: ${{ inputs.new-release-branch }}
          fetch-depth: 0

      - name: Merge previous releases
        uses: ./.github/actions/merge-previous-releases
        with:
          new-release-branch: ${{ inputs.new-release-branch }}
          github-token: ${{ secrets.github-token || secrets.GITHUB_TOKEN }}
